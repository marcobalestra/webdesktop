const buildByManifest=m=>{const $out=$("<div></div>");if(m.app_icon||m.app_name){const $h=$("<h3></h3>");m.app_icon&&$h.append(m.app_icon),m.app_name&&$h.append($("<b></b>").append(m.app_name)),$out.append($h)}m.base_uri&&$out.append($(`<p><small>${m.base_uri}</small></p>`)),m.description&&$out.append($("<div></div>").append(m.description));const lis=[];if(m.version&&lis.push(`${_l("Version")}: <b>${m.version}</b>`),m.copyright_link?lis.push(`© <a href="${m.copyright_link}" target="_blank"><b>${m.copyright||m.copyright_link}</b></a>`):m.copyright&&lis.push(`© <b>${m.copyright}</b>`),m.developer_link?lis.push(`${_l("Developer")}: <a href="${m.developer_link}" target="_blank"><b>${m.developer||m.developer_link}</b></a>`):m.developer&&lis.push(`${_l("Developer")}: <b>${m.developer||m.developer_link}</b>`),lis.length){const $ul=$("<ul></ul>");lis.forEach(li=>{$ul.append($("<li></li>").append(li))}),$out.append($ul)}return $out},getClass=async mb=>{return class{#prop;constructor(manifest,options){console.log(options),(options="object"!=typeof(options="string"==typeof options?{uri:options}:options)?{}:options).dlogOptions={uid:glob.uid("dlog"),canclose:!0,size:"lg",tooltip:"",title:"",body:"",footer:""},this.#prop=options,this.open()}show(uri){void 0!==(uri=void 0===uri?this.#prop.uri:uri)&&mb.plugin("dialog",this.#prop.dlogOptions).then(d=>{var $c=(this.#prop.dialog=d).getter();$(".modal-header",$c).remove(),$(".modal-footer",$c).remove();const $b=$(".modal-body",$c);$b.addClass("mabro-about-content"),$b.load(uri,()=>{$b.html(glob.localize.labelize($b.html())),d.show()})})}async build(){if("object"==typeof this.#prop.manifest){if(this.#prop.manifest.about)return this.show(this.#prop.manifest.base_uri+this.#prop.manifest.about);const $content=await buildByManifest(this.#prop.manifest);if($content&&$content.html().length){const d=await mb.plugin("dialog",this.#prop.dlogOptions);this.#prop.dialog=d;var $c=d.getter();$(".modal-header",$c).remove(),$(".modal-footer",$c).remove();const $b=$(".modal-body",$c);$b.addClass("mabro-about-content"),$b.empty().append($content),$b.html(glob.localize.labelize($b.html())),d.show()}}}open(){this.#prop.manifest?this.build():this.#prop.uri&&this.show()}hide(){this.close()}close(){this.#prop.dialog.dispose()}}};export default getClass;